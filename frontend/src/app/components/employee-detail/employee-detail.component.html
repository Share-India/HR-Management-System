<div class="detail-container">
    <h2>{{ isEditMode ? 'Edit Employee' : 'New Employee' }}</h2>

    <form (ngSubmit)="onSubmit()" class="employee-form">
        <fieldset [disabled]="!formEnabled" style="border: none; padding: 0; margin: 0;">
            <div class="form-row">
                <div class="form-group">
                    <label>Employee ID</label>
                    <input [(ngModel)]="employee.employeeCode" name="employeeCode" required placeholder="EMP-001">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>First Name</label>
                    <input [(ngModel)]="employee.firstName" name="firstName" required>
                </div>
                <div class="form-group">
                    <label>Last Name</label>
                    <input [(ngModel)]="employee.lastName" name="lastName" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Email</label>
                    <input [(ngModel)]="employee.email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input [(ngModel)]="employee.phone" name="phone">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Department</label>
                    <input [(ngModel)]="employee.department" name="department">
                </div>
                <div class="form-group">
                    <label>Designation</label>
                    <input [(ngModel)]="employee.designation" name="designation">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Date of Joining</label>
                    <input type="date" [(ngModel)]="employee.dateOfJoining" name="dateOfJoining">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select [(ngModel)]="employee.status" name="status">
                        <option value="Active">Active</option>
                        <option value="Resigned">Resigned</option>
                        <option value="On Leave">On Leave</option>
                    </select>
                </div>
            </div>

            <!-- Offer Letter & KYC Upload (New Employee Only) -->
            <div class="form-row" *ngIf="!isEditMode">
                <div class="form-group">
                    <label>Offer Letter (Optional)</label>
                    <input type="file" (change)="onOfferFileSelected($event)" accept=".pdf,.doc,.docx">
                </div>
                <div class="form-group">
                    <label>KYC Document (Optional)</label>
                    <input type="file" (change)="onKycFileSelected($event)" accept=".pdf,.doc,.docx,.jpg,.png">
                </div>
            </div>
        </fieldset>

        <div class="action-buttons" style="margin-top: 20px;">
            <button type="submit" class="btn-save" *ngIf="formEnabled">Save Employee</button>
            <button type="button" class="btn btn-secondary" *ngIf="!formEnabled" (click)="enableEditing()"
                style="margin-left: 10px; padding: 0.75rem 1.5rem; border-radius: 4px; border: 1px solid #ccc; background: white; cursor: pointer;">
                Edit
            </button>
        </div>
    </form>

    <div *ngIf="isEditMode" class="documents-section">
        <h3>Documents</h3>
        <div class="doc-list">
            <div *ngFor="let doc of documents" class="doc-item">
                <div class="doc-name">{{ doc.fileName }}</div>
                <div class="doc-type">{{ doc.type }}</div>
                <button (click)="downloadFile(doc.id, doc.fileName)" class="btn-download">Download</button>
            </div>
        </div>

        <!-- Resignation Section -->
        <div *ngIf="isEditMode && employee.status !== 'Resigned'" class="resignation-section"
            style="margin-top: 20px; border-top: 1px solid #ccc; padding-top: 20px;">
            <button type="button" class="btn btn-danger" (click)="showResignForm = !showResignForm">Resign
                Employee</button>

            <div *ngIf="showResignForm" class="resign-form"
                style="margin-top: 15px; background: #fff5f5; padding: 15px; border-radius: 5px;">
                <h4>Resignation Details</h4>
                <div class="form-group">
                    <label>Reason for Leaving</label>
                    <textarea [(ngModel)]="resignationReason" rows="3" class="form-control"></textarea>
                </div>
                <div class="form-group">
                    <label>Resignation Date</label>
                    <input type="date" [(ngModel)]="resignationDate">
                </div>
                <div class="form-group">
                    <label>Resignation Letter</label>
                    <input type="file" (change)="onResignationFileSelected($event)" accept=".pdf,.doc,.docx">
                </div>
                <button type="button" class="btn btn-danger" (click)="submitResignation()"
                    style="margin-top: 10px;">Confirm Resignation</button>
            </div>
        </div>
    </div>
</div>